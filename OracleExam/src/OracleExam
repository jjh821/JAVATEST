-- 1. 모든 부서들의 정보와 도시 정보를 조회한다.27
SELECT D.DEPARTMENT_ID
     , D.DEPARTMENT_NAME
     , D.MANAGER_ID
     , D.LOCATION_ID 
     , L.CITY  
   FROM DEPARTMENTS D
INNER JOIN LOCATIONS L
    ON D.LOCATION_ID = L.LOCATION_ID 
;

-- 2. 모든 사원들의 정보와 부서명을 조회한다.106
SELECT EMPLOYEE_ID
     , E.FIRST_NAME
     , E.LAST_NAME
     , E.EMAIL
     , E.PHONE_NUMBER
     , E.HIRE_DATE
     , E.JOB_ID
     , E.SALARY
     , E.COMMISSION_PCT
     , E.MANAGER_ID
     , E.DEPARTMENT_ID
     , D.DEPARTMENT_NAME 
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID   

;

-- 3. 111번 사원의 모든 정보와 부서명을 조회한다. 1
SELECT EMPLOYEE_ID
     , E.FIRST_NAME
     , E.LAST_NAME
     , E.EMAIL
     , E.PHONE_NUMBER
     , E.HIRE_DATE
     , E.JOB_ID
     , E.SALARY
     , E.COMMISSION_PCT
     , E.MANAGER_ID
     , E.DEPARTMENT_ID
     , D.DEPARTMENT_NAME 
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID   
 WHERE E.EMPLOYEE_ID = 111

-- 4. 115번의 사원의 모든 정보와 부서명, 직무명을 조회한다. 1
 SELECT EMPLOYEE_ID
     , E.FIRST_NAME
     , E.LAST_NAME
     , E.EMAIL
     , E.PHONE_NUMBER
     , E.HIRE_DATE
     , E.JOB_ID
     , E.SALARY
     , E.COMMISSION_PCT
     , E.MANAGER_ID
     , E.DEPARTMENT_ID
     , D.DEPARTMENT_NAME 
     , J.JOB_TITLE 
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
 INNER JOIN JOBS J
    ON E.JOB_ID  = J.JOB_ID  
 WHERE E.EMPLOYEE_ID = 115

-- 5. 100번 사원의 모든 정보와 부서명, 직무명, 도시명을 조회한다. 1
  SELECT EMPLOYEE_ID
     , E.FIRST_NAME
     , E.LAST_NAME
     , E.EMAIL
     , E.PHONE_NUMBER
     , E.HIRE_DATE
     , E.JOB_ID
     , E.SALARY
     , E.COMMISSION_PCT
     , E.MANAGER_ID
     , E.DEPARTMENT_ID
     , D.DEPARTMENT_NAME 
     , J.JOB_TITLE 
     , L.CITY
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
 INNER JOIN JOBS J
    ON E.JOB_ID  = J.JOB_ID  
 INNER JOIN LOCATIONS L
    ON D.LOCATION_ID   = L.LOCATION_ID 
 WHERE E.EMPLOYEE_ID = 100

-- 6. 부서명별 사원의 수를 조회한다. 11
SELECT D.DEPARTMENT_NAME  
	 , COUNT(EMPLOYEE_ID )
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID 
 GROUP BY D.DEPARTMENT_NAME 
;

-- 7. 직무명별 사원의 평균월급을 조회한다. 19
SELECT J.JOB_TITLE   
	 , AVG(E.SALARY )
  FROM EMPLOYEES E
 INNER JOIN JOBS J
    ON E.JOB_ID  = J.JOB_ID  
 GROUP BY J.JOB_TITLE
;

-- 8. 부서명, 직무명별 사원의 수와 평균월급을 조회한다. 19
SELECT D.DEPARTMENT_NAME 
	 , J.JOB_TITLE 
	 , COUNT(E.EMPLOYEE_ID )
	 , AVG(E.SALARY )
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID 
 INNER JOIN JOBS J
    ON E.JOB_ID = J.JOB_ID 
 GROUP BY D.DEPARTMENT_NAME 
	 , J.JOB_TITLE 
;
-- 9. 부서명별 평균월급을 부서명으로 내림차순 정렬하여 조회한다. 11
SELECT D.DEPARTMENT_NAME 
	 , AVG(E.SALARY ) 
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID  
 GROUP BY D.DEPARTMENT_NAME 
 ORDER BY D.DEPARTMENT_NAME DESC 
;
-- 10. 부서명별 최고월급을 최고월급으로 오름차순 정렬하여 조회한다. 11
SELECT D.DEPARTMENT_NAME 
	 , MAX(E.SALARY ) AS MAX_SAL
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID  
 GROUP BY D.DEPARTMENT_NAME 
 ORDER BY MAX_SAL ASC
;


-- 11. 도시명 별 사원의 수를 도시명으로 오름차순 정렬하여 조회한다. 7
SELECT L.CITY 
	 , COUNT(E.EMPLOYEE_ID  )
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID  
 INNER JOIN LOCATIONS L
    ON D.LOCATION_ID = L.LOCATION_ID 
 GROUP BY L.CITY  
 ORDER BY L.CITY  ASC
;

-- 12. 도시별 부서의 수를 조회한다. 7
SELECT L.CITY 
	 , COUNT( D.DEPARTMENT_ID  )
  FROM DEPARTMENTS D
 INNER JOIN LOCATIONS L
    ON D.LOCATION_ID = L.LOCATION_ID 
 GROUP BY L.CITY    
;

-- 13. 도시별 사원의 평균월급을 조회한다. 7
SELECT L.CITY 
	 , AVG ( E.SALARY   )
  FROM EMPLOYEES E
 INNER JOIN DEPARTMENTS D
    ON E.DEPARTMENT_ID = D.DEPARTMENT_ID  
 INNER JOIN LOCATIONS L
    ON D.LOCATION_ID = L.LOCATION_ID 
 GROUP BY L.CITY    
;